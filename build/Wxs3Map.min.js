var Wxs3Map=function(e){function t(i){if(r[i])return r[i].exports;var n=r[i]={exports:{},id:i,loaded:!1};return e[i].call(n.exports,n,n.exports,t),n.loaded=!0,n.exports}var r={};return t.m=e,t.c=r,t.p="",t(0)}([function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function o(e){var t=l.extend({},w.texture,e.texture||{}),r=l.extend({},w.terrain,e.terrain||{}),i=l.extend({},w,e);return i.texture=t,i.terrain=r,i}function a(e){var t,r,i=document.getElementById(e.div),n=i.clientWidth,o=i.clientHeight,a=(0,x["default"])(e.bbox,e.crs,e.bboxCrs),s=a.width(),u=a.height();if(e.texture.imgWidth&&e.texture.imgHeight)t=e.texture.imgWidth,r=e.texture.imgHeight;else{var l=s/u;n/o<l?(t=n,r=Math.round(t/l)):(r=o,t=Math.round(r*l))}var d=Math.round(t/e.terrain.pixelsPerVertex),f=Math.round(r/e.terrain.pixelsPerVertex);d>s/e.terrain.wcsResolution&&(d=Math.round(s/e.terrain.wcsResolution),f=Math.round(u/e.terrain.wcsResolution));var h=s/d,c=u/f,p=(h+c)/2;e.zInv&&(p*=-1);var m;return m=e.zMult?p/e.zMult:p,{config:e,div:i,envelope:a,width:n,height:o,imgWidth:t,imgHeight:r,demWidth:d,demHeight:f,zMult:m,crs:e.crs}}function s(e){e=o(e||{});var t,r=a(e),i=(0,c["default"])(e.texture,r),n=(0,m["default"])(e.terrain,r);return e.profiles&&(t=(0,y["default"])(e.profiles,n,r)),new f["default"](r,n,i,t)}Object.defineProperty(t,"__esModule",{value:!0});var u=r(1),l=n(u),d=r(2),f=i(d),h=r(14),c=i(h),p=r(15),m=i(p),v=r(16),y=i(v),g=r(17),x=i(g),w={div:null,bbox:null,bboxCrs:"EPSG:4326",wireframe:!1,zMult:1,zInv:!1,crs:"EPSG:32633",texture:{type:"wms",wmsUrl:"http://openwms.statkart.no/skwms1/wms.topo2",wmsLayers:"topo2_WMS",wmsFormat:"image/png",wmsFormatMode:""},terrain:{pixelsPerVertex:8,wcsUrl:"http://wms.geonorge.no/skwms1/wcs.dtm",wcsResolution:10,coverage:"land_utm33_10m",format:"geotiff",showBox:!0,boxColor:14540253},profiles:null};window.Wxs3Map=s,t["default"]=s},function(e,t){e.exports=_},function(e,t,r){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function n(e){return e&&e.__esModule?e:{"default":e}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(3),a=r(4),s=n(a),u=r(1),l=i(u),d=r(5),f=(n(d),r(6)),h=(n(f),r(7)),c=n(h),p=r(8),m=n(p),v=function(e,t,r,i){this.dim=e,this.terrain=t,this.texture=r,this.profiles=i,this.events=(0,c["default"])(),this.reloadTimer=-1,this.linesToClamp=[],this._renderer=this._createRenderer(),this._camera=this._createCamera(),this._controls=this._createControls(),this._material=this._createMaterial();var n=this._createMesh();this._scene=this._createScene(n),this.dim.div.appendChild(this._renderer.domElement),this._render(),this.events.fire("onTerrainLoadStart"),this.terrain.loadTerrain(this._terrainLoaded.bind(this)),this.events.fire("onTextureLoadStart"),this.texture.loadTexture(this._material,this._textureLoaded.bind(this)),window.addEventListener("resize",this._resizeMe.bind(this),!1),this.on("onTerrainLoadEnd",this._clampLines,this)};v.prototype.on=function(e,t,r){this.events.on(e,t,r)},v.prototype._terrainLoaded=function(){this.events.fire("onTerrainLoadEnd"),this._scene.add(this.terrain.getSides()),this.profiles&&this.profiles.load(this._profilesLoaded.bind(this))},v.prototype._profilesLoaded=function(e){l.each(e,function(e){this._scene.add(e)},this)},v.prototype._textureLoaded=function(e){this.events.fire("onTextureLoadEnd")},v.prototype._createRenderer=function(){var e=new o.WebGLRenderer({alpha:!0});return e.setSize(this.dim.width,this.dim.height),e},v.prototype._createScene=function(e){var t=new o.Scene;return t.add(new o.AmbientLight(16777215)),t.add(e),t},v.prototype._createCamera=function(){var e,t=45,r=new o.PerspectiveCamera(t,this.dim.width/this.dim.height,.1,1e3);if(this.dim.Z)e=this.dim.Z;else{var i,n=this.dim.width/this.dim.height;i=n<this.dim.demWidth/this.dim.demHeight?this.dim.demWidth/n:this.dim.demHeight,e=i/2/Math.tan(t/2*Math.PI/180)}return r.position.set(0,0,e),r},v.prototype._createMaterial=function(){var e=new o.MeshPhongMaterial({side:this.terrain.showBox?o.FrontSide:o.DoubleSide});return e.wireframe=this.dim.wireframe,e},v.prototype._createMesh=function(){return new o.Mesh(this.terrain.getGeometry(),this._material)},v.prototype._createControls=function(){return new s["default"](this._camera)},v.prototype._render=function(){this._controls.update(),window.requestAnimationFrame(this._render.bind(this)),this._renderer.render(this._scene,this._camera)},v.prototype._resizeMe=function(){window.clearTimeout(this.reloadTimer),this.reloadTimer=window.setTimeout(this._reloadAll.bind(this),1e3)},v.prototype._reloadAll=function(){this.dim.width=this.dim.div.clientWidth,this.dim.height=this.dim.div.clientHeight,this._camera.aspect=this.dim.width/this.dim.height,this._camera.updateProjectionMatrix(),delete this._controls,this._controls=this._createControls(),this._renderer.setSize(this.dim.width,this.dim.height)},v.prototype.addLine=function(e,t){var r=(0,m["default"])(e,t,this.terrain.getGeometry(),this.dim.envelope),i=r.getThreeLine();this._scene.add(i),r.needsClamp()&&this.linesToClamp.push(r)},v.prototype._clampLines=function(){l.each(this.linesToClamp,function(e){var t=e.getThreeLine(),r=e.clamp();this._scene.remove(t),this._scene.add(r)},this),this.linesToClamp=[]},t["default"]=v},function(e,t){e.exports=THREE},function(e,t){e.exports=TrackballControls},function(e,t){"use strict";function r(){this.tiffDataView=void 0,this.littleEndian=void 0,this.fileDirectories=[]}Object.defineProperty(t,"__esModule",{value:!0}),r.prototype={isLittleEndian:function(){var e=this.getBytes(2,0);if(18761===e)this.littleEndian=!0;else{if(19789!==e)throw console.log(e),TypeError("Invalid byte order value.");this.littleEndian=!1}return this.littleEndian},hasTowel:function(){if(42!==this.getBytes(2,2))throw RangeError("You forgot your towel!");return!0},getFieldTagName:function(e){var t,r={315:"Artist",258:"BitsPerSample",265:"CellLength",264:"CellWidth",320:"ColorMap",259:"Compression",33432:"Copyright",306:"DateTime",338:"ExtraSamples",266:"FillOrder",289:"FreeByteCounts",288:"FreeOffsets",291:"GrayResponseCurve",290:"GrayResponseUnit",316:"HostComputer",270:"ImageDescription",257:"ImageLength",256:"ImageWidth",271:"Make",281:"MaxSampleValue",280:"MinSampleValue",272:"Model",254:"NewSubfileType",274:"Orientation",262:"PhotometricInterpretation",284:"PlanarConfiguration",296:"ResolutionUnit",278:"RowsPerStrip",277:"SamplesPerPixel",305:"Software",279:"StripByteCounts",273:"StripOffsets",255:"SubfileType",263:"Threshholding",282:"XResolution",283:"YResolution",326:"BadFaxLines",327:"CleanFaxData",343:"ClipPath",328:"ConsecutiveBadFaxLines",433:"Decode",434:"DefaultImageColor",269:"DocumentName",336:"DotRange",321:"HalftoneHints",346:"Indexed",347:"JPEGTables",285:"PageName",297:"PageNumber",317:"Predictor",319:"PrimaryChromaticities",532:"ReferenceBlackWhite",339:"SampleFormat",559:"StripRowCounts",330:"SubIFDs",292:"T4Options",293:"T6Options",325:"TileByteCounts",323:"TileLength",324:"TileOffsets",322:"TileWidth",301:"TransferFunction",318:"WhitePoint",344:"XClipPathUnits",286:"XPosition",529:"YCbCrCoefficients",531:"YCbCrPositioning",530:"YCbCrSubSampling",345:"YClipPathUnits",287:"YPosition",37378:"ApertureValue",40961:"ColorSpace",36868:"DateTimeDigitized",36867:"DateTimeOriginal",34665:"Exif IFD",36864:"ExifVersion",33434:"ExposureTime",41728:"FileSource",37385:"Flash",40960:"FlashpixVersion",33437:"FNumber",42016:"ImageUniqueID",37384:"LightSource",37500:"MakerNote",37377:"ShutterSpeedValue",37510:"UserComment",33723:"IPTC",34675:"ICC Profile",700:"XMP",42112:"GDAL_METADATA",42113:"GDAL_NODATA",34377:"Photoshop"};return t=e in r?r[e]:"Tag"+e},getFieldTypeName:function(e){var t,r={1:"BYTE",2:"ASCII",3:"SHORT",4:"LONG",5:"RATIONAL",6:"SBYTE",7:"UNDEFINED",8:"SSHORT",9:"SLONG",10:"SRATIONAL",11:"FLOAT",12:"DOUBLE"};return e in r&&(t=r[e]),t},getFieldTypeLength:function(e){var t;return["BYTE","ASCII","SBYTE","UNDEFINED"].indexOf(e)!==-1?t=1:["SHORT","SSHORT"].indexOf(e)!==-1?t=2:["LONG","SLONG","FLOAT"].indexOf(e)!==-1?t=4:["RATIONAL","SRATIONAL","DOUBLE"].indexOf(e)!==-1&&(t=8),t},getBits:function(e,t,r){r=r||0;var i=Math.floor(r/8),n=t+i,o=r+e,a=32-e;if(o<=0)throw console.log(e,t,r),RangeError("No bits requested");if(o<=8)var s=24+r,u=this.tiffDataView.getUint8(n,this.littleEndian);else if(o<=16)var s=16+r,u=this.tiffDataView.getUint16(n,this.littleEndian);else{if(!(o<=32))throw console.log(e,t,r),RangeError("Too many bits requested");var s=r,u=this.tiffDataView.getUint32(n,this.littleEndian)}var l={bits:u<<s>>>a,byteOffset:n+Math.floor(o/8),bitOffset:o%8};return l},getBytes:function(e,t){if(e<=0)throw console.log(e,t),RangeError("No bytes requested");if(e<=1)return this.tiffDataView.getUint8(t,this.littleEndian);if(e<=2)return this.tiffDataView.getUint16(t,this.littleEndian);if(e<=3)return this.tiffDataView.getUint32(t,this.littleEndian)>>>8;if(e<=4)return this.tiffDataView.getUint32(t,this.littleEndian);throw console.log(e,t),RangeError("Too many bytes requested")},getFieldValues:function(e,t,r,i){var n=[],o=this.getFieldTypeLength(t),a=o*r;if(a<=4){if(this.littleEndian===!1)var s=i>>>8*(4-o);else var s=i;n.push(s)}else for(var u=0;u<r;u++){var l=o*u;if(o>=8)if(["RATIONAL","SRATIONAL"].indexOf(t)!==-1)n.push(this.getBytes(4,i+l)),n.push(this.getBytes(4,i+l+4));else{if(["DOUBLE"].indexOf(t)===-1)throw console.log(t,r,a),TypeError("Can't handle this field type or size");n.push(this.getBytes(4,i+l)+this.getBytes(4,i+l+4))}else n.push(this.getBytes(o,i+l))}return"ASCII"===t&&n.forEach(function(e,t,r){r[t]=String.fromCharCode(e)}),n},clampColorSample:function(e,t){var r=Math.pow(2,8-t);return Math.floor(e*r+(r-1))},makeRGBAFillValue:function(e,t,r,i){return"undefined"==typeof i&&(i=1),"rgba("+e+", "+t+", "+r+", "+i+")"},parseFileDirectory:function(e){for(var t=this.getBytes(2,e),r=[],i=e+2,n=0;n<t;i+=12,n++){var o=this.getBytes(2,i),a=this.getBytes(2,i+2),s=this.getBytes(4,i+4),u=this.getBytes(4,i+8),l=this.getFieldTagName(o),d=this.getFieldTypeName(a),f=this.getFieldValues(l,d,s,u);r[l]={type:d,values:f}}this.fileDirectories.push(r);var h=this.getBytes(4,i);return 0===h?this.fileDirectories:this.parseFileDirectory(h)},parseTIFF:function(e,t){if(t=t||document.createElement("canvas"),this.tiffDataView=new DataView(e),this.canvas=t,this.littleEndian=this.isLittleEndian(this.tiffDataView),this.hasTowel(this.tiffDataView,this.littleEndian)){var r=this.getBytes(4,4);this.fileDirectories=this.parseFileDirectory(r);var i=this.fileDirectories[0],n=i.ImageWidth.values[0],o=i.ImageLength.values[0];this.canvas.width=n,this.canvas.height=o;var a=[],s=i.Compression?i.Compression.values[0]:1,u=i.SamplesPerPixel.values[0],l=[],d=0,f=!1;if(i.BitsPerSample.values.forEach(function(e,t,r){l[t]={bitsPerSample:e,hasBytesPerSample:!1,bytesPerSample:void 0},e%8===0&&(l[t].hasBytesPerSample=!0,l[t].bytesPerSample=e/8),d+=e},this),d%8===0){f=!0;var h=d/8}var c=i.StripOffsets.values,p=c.length;if(i.StripByteCounts)var m=i.StripByteCounts.values;else{if(console.log("Missing StripByteCounts!"),1!==p)throw Error("Cannot recover from missing StripByteCounts");var m=[Math.ceil(n*o*d/8)]}for(var v=0;v<p;v++){var y=c[v];a[v]=[];for(var g=m[v],x=0,w=0,_=1,b=!0,S=[],M=0,E=0,T=0;x<g;x+=_)switch(s){case 1:for(var P=0,S=[];P<u;P++){if(!l[P].hasBytesPerSample){var C=this.getBits(l[P].bitsPerSample,y+x,w);throw S.push(C.bits),x=C.byteOffset-y,w=C.bitOffset,RangeError("Cannot handle sub-byte bits per sample")}var O=l[P].bytesPerSample*P;S.push(this.tiffDataView.getFloat32(y+x+O,this.littleEndian))}if(a[v].push(S),!f)throw _=0,RangeError("Cannot handle sub-byte bits per pixel");_=h;break;case 2:break;case 3:break;case 4:break;case 5:break;case 6:break;case 7:break;case 32773:if(b){b=!1;var B=1,L=1,D=this.tiffDataView.getInt8(y+x,this.littleEndian);D>=0&&D<=127?B=D+1:D>=-127&&D<=-1?L=-D+1:b=!0}else{for(var I=this.getBytes(1,y+x),P=0;P<L;P++){if(!l[E].hasBytesPerSample)throw RangeError("Cannot handle sub-byte bits per sample");T=T<<8*M|I,M++,M===l[E].bytesPerSample&&(S.push(T),T=M=0,E++),E===u&&(a[v].push(S),S=[],E=0)}B--,0===B&&(b=!0)}_=1}}return a;var v}}},t["default"]=r},function(e,t,r){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function n(e){return a.map(e,function(e,t){return encodeURIComponent(t)+"="+encodeURIComponent(e)}).join("&")}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n;var o=r(1),a=i(o)},function(e,t,r){"use strict";function i(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0});var n=r(1),o=i(n),a=function(){var e={};return{on:function(t,r,i){e[t]||(e[t]=[]),i&&(r=r.bind(i)),e[t].push(r)},fire:function(t,r){e[t]&&o.each(e[t],function(e){e(t,r)})}}};t["default"]=a},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function o(e,t,r,i){function n(e,r){var i=s.map(e,function(e){return new u.Vector3(e.x,e.y,e.z)}),n=new u.LineBasicMaterial(t),o=new u.Geometry;return o.vertices=i,new u.Line(o,n)}function o(){if(f)return f;if("LineString"!==e.type)throw new Error("Expected GeoJSON LineString geometry");var t=i.minX(),o=i.minY();r.computeBoundingBox();var a=r.boundingBox,u=a.min.x,l=a.min.y,p=Math.abs(a.max.x-u),m=Math.abs(a.max.y-l),v=i.width()/p,y=i.height()/m,g=s.map(e.coordinates,function(e){return(0,h["default"])(e,"EPSG:4326",i.mapCrs)}),x=s.map(g,function(e){var r=e[0],i=u+(r-t)/v,n=e[1],a=l+(n-o)/y;return{x:i,y:a,z:0}});return r.loaded&&(x=(0,d["default"])(x,r)),f=n(x),r.loaded&&(c=!1),f}function a(){return f=n((0,d["default"])(f.geometry.vertices,r))}var l={color:255,linewidth:5};t=s.extend({},l,t||{});var f,c=!0;return{getThreeLine:o,clamp:a,needsClamp:function p(){return p}}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(1),s=n(a),u=r(3),l=r(9),d=i(l),f=r(12),h=i(f);t["default"]=o},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function o(e,t,r,i,n){var o=(t.y-r.y)*(e.x-r.x)+(r.x-t.x)*(e.y-r.y),a=((t.y-r.y)*(i-r.x)+(r.x-t.x)*(n-r.y))/o,s=((r.y-e.y)*(i-r.x)+(e.x-r.x)*(n-r.y))/o,u=1-a-s;return a*e.z+s*t.z+u*r.z}function a(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function s(e,t){return d.chain(t.faces).map(function(r){var i=t.vertices[r.a],n=t.vertices[r.b],s=t.vertices[r.c],u=[i,n],l=[n,s],f=[s,i],c=[];return(0,h["default"])(e,u)&&c.push((0,p["default"])(u,e)),(0,h["default"])(e,l)&&c.push((0,p["default"])(l,e)),(0,h["default"])(e,f)&&c.push((0,p["default"])(f,e)),d.map(c,function(t){var r=o(i,n,s,t.x,t.y);return{x:t.x,y:t.y,z:r+.01,dist:a(e[0],t)}})}).flatten().sortBy(function(e){return Math.abs(e.dist)}).value()}function u(e,t){var r=d.map(d.range(0,e.length-1),function(r){var i=e[r],n=e[r+1];return s([i,n],t)});return d.flatten(r)}Object.defineProperty(t,"__esModule",{value:!0});var l=(r(3),r(1)),d=n(l),f=r(10),h=i(f),c=r(11),p=i(c);t["default"]=u},function(e,t){"use strict";function r(e,t,r){var i=e.x,n=e.y,o=t.x,a=t.y,s=r.x,u=r.y,l=(u-n)*(o-i),d=(a-n)*(s-i);return l>d+Number.EPSILON?1:l+Number.EPSILON<d?-1:0}function i(e,t){var i=e[0],n=e[1],o=t[0],a=t[1];return r(i,o,a)!==r(n,o,a)&&r(i,n,o)!==r(i,n,a)}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=i},function(e,t){"use strict";function r(e,t){var r,i,n=e[0].x,o=e[0].y,a=e[1].x,s=e[1].y,u=t[0].x,l=t[0].y,d=t[1].x,f=t[1].y,h=(f-l)*(a-n)-(d-u)*(s-o);return 0===h?null:(r=((d-u)*(o-l)-(f-l)*(n-u))/h,i=((a-n)*(o-l)-(s-o)*(n-u))/h,{x:n+r*(a-n),y:o+r*(s-o),z:0})}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=r},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function n(e,t,r){return(0,a["default"])(t,r,e)}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=n;var o=r(13),a=i(o);a["default"].defs("EPSG:32632","+title=EPSG Projection 32632 - WGS 84 / UTM zone 32N +proj=utm +zone=32 +ellps=WGS84 +datum=WGS84 +units=m +no_defs"),a["default"].defs("EPSG:32633","+title=EPSG Projection 32633 - WGS 84 / UTM zone 33N +proj=utm +zone=33 +ellps=WGS84 +datum=WGS84 +units=m +no_defs")},function(e,t){e.exports=proj4},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function n(e,t){function r(){if(e.imgUrl)return e.imgUrl;var r={service:"wms",version:"1.3.0",request:"getMap",crs:t.crs,WIDTH:t.imgWidth,HEIGHT:t.imgHeight,bbox:t.envelope.bbox(),layers:e.wmsLayers,format:e.wmsFormat+e.wmsFormatMode};return e.wmsUrl+"?"+(0,s["default"])(r)}function i(e,t){var i=new o.TextureLoader,n=r();i.load(n,function(r){r.minFilter=o.LinearFilter,e.map=r,e.needsUpdate=!0,t&&t(r)},function(e){},function(e){console.log("An error happened on texture load: "+n)})}return{loadTexture:i}}Object.defineProperty(t,"__esModule",{value:!0});var o=r(3),a=r(6),s=i(a);t["default"]=n},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}Object.defineProperty(t,"__esModule",{value:!0});var o=r(3),a=r(1),s=n(a),u=r(5),l=i(u),d=r(6),f=i(d),h=function(e,t){function r(e){for(var t=new l["default"],r=t.parseTIFF(e.response),i=[],n=0;n<r.length;n++)for(var o=0;o<r[n].length;o++)i.push(parseInt(r[n][o][0],10));return i}function i(e){for(var t=p.vertices.length,r=e.responseText.split("\n"),i=[],n=0,o=t;n<o;n++)i[n]=parseInt(r[n].split(" ")[2],10);return i}function n(e){var n=y?r(e):i(e),o=s.min(n),a=s.max(n),u=(a+o)/2;return{height:n,midHeight:u,minHeight:(o-u)/t.zMult}}function a(){p=new o.PlaneGeometry(t.demWidth,t.demHeight,t.demWidth-1,t.demHeight-1)}function u(e){for(var r=0,i=p.vertices.length;r<i;r++)p.vertices[r].z=(e.height[r]-e.midHeight)/t.zMult;p.loaded=!0,p.verticesNeedUpdate=!0,m=e.minHeight,v=e.midHeight}function d(r){var i=new XMLHttpRequest,o={SERVICE:"WCS",VERSION:"1.0.0",REQUEST:"GetCoverage",COVERAGE:e.coverage,FORMAT:e.format,bbox:t.envelope.bbox(),CRS:t.crs,RESPONSE_CRS:t.crs,WIDTH:t.demWidth,HEIGHT:t.demHeight},a=e.wcsUrl+"?"+(0,f["default"])(o);y&&(i.responseType="arraybuffer"),i.open("GET",a,!0),i.onreadystatechange=function(){4===this.readyState&&(u(n(this)),r())},i.send()}function h(t){var r=s.chain(p.vertices).filter(t).map(function(e){return[new o.Vector3(e.x,e.y,e.z),new o.Vector3(e.x,e.y,m)]}).flatten().value(),i=s.first(r).clone(),n=s.last(r).clone();i.z=m,n.z=m;var a=new o.Geometry;r.unshift(i),r.push(n);var u=s.map(s.range(1,r.length-1),function(e){return new o.Face3(e-1,e,e+1)});return a.vertices=r,a.faces=u,new o.Mesh(a,new o.MeshBasicMaterial({side:o.DoubleSide,color:e.boxColor,wireframe:!1}))}function c(){if(!e.showBox)return null;for(var r=new o.MeshBasicMaterial({wireframe:!1,color:e.boxColor,side:o.BackSide}),i=new o.PlaneGeometry(t.demWidth,t.demHeight,t.demWidth-1,t.demHeight-1),n=0,a=i.vertices.length;n<a;n++)i.vertices[n].z=m;var s=new o.Group;s.add(new o.Mesh(i,r)),p.computeBoundingBox();var u=p.boundingBox,l=function(e){return e.x===u.min.x},d=function(e){return e.y===u.min.y},f=function(e){return e.x===u.max.x},c=function(e){return e.y===u.max.y};return s.add(h(d)),s.add(h(f)),s.add(h(l)),s.add(h(c)),s}var p,m,v,y="geotiff"===e.format;return a(),{loadTerrain:d,getGeometry:function(){return p},minHeight:function(){return m},midHeight:function(){return v},getSides:c,showBox:e.showBox}};t["default"]=h},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function o(e,t,r){function i(e,t,r,i){return"string"==typeof r&&(r=1*r,i=1*i),(0,h["default"])([r,i],e,t)}function n(e,n){var o=new u.PlaneGeometry(1,1),a=new u.MeshPhongMaterial({side:u.DoubleSide,transparent:!0}),s=e.CRS;if(s!==n.crsDestination){var l=i(s,n.crsDestination,e.xyStart.x,e.xyStart.y),f=i(s,n.crsDestination,e.xyEnd.x,e.xyEnd.y);e.xyStart.x=l[0],e.xyStart.y=l[1],e.xyEnd.x=f[0],e.xyEnd.y=f[1]}var h=n.kX*e.xyStart.x-n.kX*r.envelope.minX()-r.demWidth/2,c=n.kY*e.xyStart.y-n.kY*r.envelope.minY()-r.demHeight/2,p=n.kX*e.xyEnd.x-n.kX*r.envelope.minX()-r.demWidth/2,m=n.kY*e.xyEnd.y-n.kY*r.envelope.minY()-r.demHeight/2,v=e.zStart-t.midHeight(),y=e.zEnd-t.midHeight(),g=new u.Mesh(o,a);g.geometry.vertices[0].x=h,g.geometry.vertices[0].y=c,g.geometry.vertices[1].x=p,g.geometry.vertices[1].y=m,g.geometry.vertices[2].x=h,g.geometry.vertices[2].y=c,g.geometry.vertices[3].x=p,g.geometry.vertices[3].y=m,e.zStart-t.midHeight(),g.geometry.vertices[0].z=v/r.zMult,g.geometry.vertices[1].z=v/r.zMult,g.geometry.vertices[2].z=y/r.zMult,g.geometry.vertices[3].z=y/r.zMult;var x=(0,d["default"])({type:"image",imgUrl:e.imgUrl},null);return x.loadTexture(a),g}function o(i){var o=t.getGeometry(),a=o.vertices[o.vertices.length-r.demWidth],u=o.vertices[r.demWidth-1],l={crsDestination:r.crs,kX:(u.x-a.x)/r.envelope.width(),kY:(u.y-a.y)/r.envelope.height()},d=s.map(e,function(e){return n(e,l)});i(d)}return{load:o}}Object.defineProperty(t,"__esModule",{value:!0});var a=r(1),s=n(a),u=r(3),l=r(14),d=i(l),f=r(12),h=i(f);t["default"]=o},function(e,t,r){"use strict";function i(e){return e&&e.__esModule?e:{"default":e}}function n(e){if(e&&e.__esModule)return e;var t={};if(null!=e)for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t["default"]=e,t}function o(e,t,r){function i(){return h[2]-h[0]}function n(){return h[3]-h[1]}function o(){return h.join(",")}function a(){return h[0]}function u(){return h[1]}var e=s.map(e.split(","),parseFloat),d=[e[0],e[1]],f=[e[2],e[3]];t!==r&&(d=(0,l["default"])(d,r,t),f=(0,l["default"])(f,r,t));var h=d.concat(f);return{width:i,height:n,bbox:o,minX:a,minY:u,mapCrs:t}}Object.defineProperty(t,"__esModule",{value:!0}),t["default"]=o;var a=r(1),s=n(a),u=r(12),l=i(u)}]);
//# sourceMappingURL=Wxs3Map.min.js.map